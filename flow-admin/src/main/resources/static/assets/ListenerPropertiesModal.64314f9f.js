var P=Object.defineProperty;var j=Object.getOwnPropertySymbols;var _=Object.prototype.hasOwnProperty,w=Object.prototype.propertyIsEnumerable;var g=(s,r,e)=>r in s?P(s,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[r]=e,B=(s,r)=>{for(var e in r||(r={}))_.call(r,e)&&g(s,e,r[e]);if(j)for(var e of j(r))w.call(r,e)&&g(s,e,r[e]);return s};var F=(s,r,e)=>new Promise((n,a)=>{var d=t=>{try{o(e.next(t))}catch(l){a(l)}},u=t=>{try{o(e.throw(t))}catch(l){a(l)}},o=t=>t.done?n(t.value):Promise.resolve(t.value).then(d,u);o((e=e.apply(s,r)).next())});import{B as D,a as C}from"./index.309f7e13.js";import{B as k}from"./BasicForm.bfb70ce4.js";import{u as A}from"./useForm.9d0149a6.js";import{k as R,l as L,m as N}from"./listener.data.e668fe68.js";import{_ as S}from"./index.aeb7d9f7.js";import{A as $,r as T,u as x,j as V,a0 as b,B as O,a1 as U,a6 as W,w as q,a4 as z}from"./vendor.5879c5ca.js";import"./useWindowSizeFn.6a6adedd.js";/* empty css               *//* empty css               *//* empty css               *//* empty css                *//* empty css              *//* empty css               *//* empty css                *//* empty css                */import"./index.661e65ad.js";/* empty css                *//* empty css                *//* empty css                *//* empty css                */import"./uuid.2b29000c.js";import"./download.6c7231a4.js";import"./base64Conver.bb012c73.js";import"./index.77bdba74.js";const G=$({name:"ListenerPropertiesModal",components:{BasicModal:D,BasicForm:k},emits:["success","register"],setup(s,{emit:r}){const e=T(!0);let n=[{label:"\u5B57\u7B26\u4E32",value:"string"},{label:"\u8868\u8FBE\u5F0F",value:"expression"}],a={};n.forEach(i=>{a[i.value]=i.label});const[d,{resetFields:u,updateSchema:o,setFieldsValue:t,validate:l}]=A({labelWidth:100,schemas:R,showActionButtonGroup:!1}),v=i=>[{trigger:"blur",validator:(m,c)=>c?L({id:i.id,field:i.field,fieldValue:c,fieldName:i.fieldName}).then(f=>f?Promise.resolve():Promise.reject(i.fieldName+"\u5DF2\u5B58\u5728\uFF0C\u8BF7\u4FEE\u6539\uFF01")).catch(f=>Promise.reject(f)):Promise.resolve()}],[E,{setModalProps:p,closeModal:h}]=C(i=>F(this,null,function*(){yield u(),p({confirmLoading:!1}),e.value=!!(i==null?void 0:i.isUpdate);let m=i.record;o({field:"value",label:a[m.type]}),yield o([{field:"type",componentProps:{options:n,onChange:c=>{o({field:"value",label:a[c.target.value]})}}},{field:"name",dynamicRules:()=>[{required:!0,whitespace:!0,message:"\u6807\u8BC6\u4E0D\u80FD\u4E3A\u7A7A\uFF01"},{max:80,message:"\u5B57\u7B26\u957F\u5EA6\u4E0D\u80FD\u5927\u4E8E80\uFF01"},...v({id:x(e)&&m&&m.id||"",field:"name",fieldValue:"",fieldName:"\u540D\u79F0"})]}]),t(B({},i.record))})),y=V(()=>x(e)?"\u4FEE\u6539":"\u65B0\u589E");function M(){return F(this,null,function*(){try{p({confirmLoading:!0});const i=yield l();yield N(i),h(),r("success")}finally{p({confirmLoading:!1})}})}return{registerModal:E,registerForm:d,getTitle:y,handleSubmit:M}}});function I(s,r,e,n,a,d){const u=b("BasicForm"),o=b("BasicModal");return O(),U(o,z(s.$attrs,{onRegister:s.registerModal,title:s.getTitle,onOk:s.handleSubmit}),{default:W(()=>[q(u,{onRegister:s.registerForm},null,8,["onRegister"])]),_:1},16,["onRegister","title","onOk"])}var Be=S(G,[["render",I]]);export{Be as default};
