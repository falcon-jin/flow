var w=(s,c,o)=>new Promise((l,n)=>{var u=a=>{try{r(o.next(a))}catch(i){n(i)}},d=a=>{try{r(o.throw(a))}catch(i){n(i)}},r=a=>a.done?l(a.value):Promise.resolve(a.value).then(u,d);r((o=o.apply(s,c)).next())});import{B as R,a as E}from"./index.309f7e13.js";import{B as M}from"./TableImg.56f74f95.js";import{T as F}from"./BasicForm.bfb70ce4.js";import{u as W}from"./useTable.df715f1a.js";import{g as N}from"./personal.6a9b7edd.js";import{P as O}from"./index.37a89528.js";import L from"./OrgTree.c66e561f.js";import{z as $,ba as S,A,r as _,j as D,a0 as m,B as g,a1 as T,a6 as j,H as z,D as V,ap as H,ae as K,J,ab as q,w as b,a4 as G}from"./vendor.5879c5ca.js";/* empty css               */import{_ as Q}from"./index.aeb7d9f7.js";import"./useWindowSizeFn.6a6adedd.js";/* empty css                *//* empty css              */import"./useForm.9d0149a6.js";/* empty css                *//* empty css                */import"./uuid.2b29000c.js";/* empty css               */import"./useSortable.514a2720.js";/* empty css                *//* empty css                *//* empty css               *//* empty css               */import"./index.661e65ad.js";/* empty css                *//* empty css                *//* empty css                */import"./download.6c7231a4.js";import"./base64Conver.bb012c73.js";import"./index.77bdba74.js";/* empty css                *//* empty css                */import"./useContentViewHeight.6345b5e8.js";import"./Tree.vue_vue_type_style_index_0_lang.6dd32286.js";import"./useContextMenu.c42040e5.js";import"./dept.1a4c42ff.js";const U=[{title:"\u59D3\u540D",dataIndex:"name",width:80,align:"left"},{title:"\u5DE5\u53F7",dataIndex:"code",width:80,align:"left"},{title:"\u6027\u522B",dataIndex:"sex",width:50,customRender:({record:s})=>{const o=~~s.sex==1,l=o?"green":"red",n=o?"\u7537":"\u5973";return $(S,{color:l},()=>n)}},{title:"\u516C\u53F8",dataIndex:"companyName",width:120,align:"left"},{title:"\u90E8\u95E8",dataIndex:"deptName",width:120,align:"left"}],C=[{field:"keyword",label:"\u5173\u952E\u5B57",component:"Input",labelWidth:60,colProps:{span:12,lg:{span:12,offset:0},sm:{span:10,offset:0},xs:{span:16,offset:0}},componentProps:{}}];const X=A({props:{title:{type:String,default:"\u4EBA\u5458\u9009\u62E9"}},name:"PersonalSelector",components:{BasicModal:R,BasicTable:M,PageWrapper:O,OrgTree:L,TableAction:F,Tag:S},setup(s,{emit:c}){const o=_([]),l=_(!1),[n,{setModalProps:u,closeModal:d}]=E(t=>w(this,null,function*(){const{selectorProps:e}=t;console.log(e.selectedList),o.value=e.selectedList,l.value=e.multiSelect,p(o.value.map(P=>P.code)),i({rowSelection:{type:e.multiSelect?"checkbox":"radio",columnWidth:30}}),u({wrapClassName:"selector-content"}),a()}));C.forEach(t=>{t&&(t.componentProps.onkeypress=e=>{e.keyCode===13&&a()})});const[r,{reload:a,setProps:i,getSelectRows:f,setSelectedRowKeys:p}]=W({title:"",api:N,columns:U,immediate:!1,rowSelection:{type:"checkbox",columnWidth:30},formConfig:{labelWidth:60,schemas:C,showResetButton:!1,showAdvancedButton:!1,autoSubmitOnEnter:!0},clickToRowSelect:!0,rowKey:"code",size:"small",canResize:!1,useSearchForm:!0,showTableSetting:!1,showIndexColumn:!1,bordered:!0,scroll:{y:280}}),h=D(()=>"\u9009\u62E9\u4EBA\u5458");function v(){a()}function y(t){o.value.splice(o.value.findIndex(e=>e.code===t),1),p(o.value.map(e=>e.code))}function x({rows:t}){o.value=t.map(e=>({id:e.id,code:e.code,name:e.name}))}function B(){x({rows:f()})}function k(){const t=f();c("success",t),d()}function I(t){let e={};t&&t.sourceType==="1"?e={companyId:t.id}:t&&t.sourceType==="2"&&(e={deptId:t.id}),a({searchInfo:e})}return{registerTable:r,registerModal:n,getTitle:h,selectedList:o,removeSelectedItem:y,rowClick:B,selectionChanged:x,handleSubmit:k,handleSuccess:v,handleSelect:I}}}),Y={class:"selected-items"};function Z(s,c,o,l,n,u){const d=m("Tag"),r=m("OrgTree"),a=m("BasicTable"),i=m("PageWrapper"),f=m("BasicModal");return g(),T(f,G({wrapClassName:"selector-body"},s.$attrs,{onRegister:s.registerModal,title:s.getTitle,onOk:s.handleSubmit}),{default:j(()=>[z("div",Y,[(g(!0),V(q,null,H(s.selectedList,p=>(g(),T(d,{color:"processing",closable:"",onClose:h=>s.removeSelectedItem(p.code)},{default:j(()=>[K(J(p.name),1)]),_:2},1032,["onClose"]))),256))]),b(i,{dense:"",contentClass:"flex"},{default:j(()=>[b(r,{class:"w-1/4 xl:w-3/10",onSelect:s.handleSelect},null,8,["onSelect"]),b(a,{onRegister:s.registerTable,onSelectionChange:s.selectionChanged,onRowClick:s.rowClick,class:"w-3/4 xl:w-7/10"},null,8,["onRegister","onSelectionChange","onRowClick"])]),_:1})]),_:1},16,["onRegister","title","onOk"])}var Oe=Q(X,[["render",Z]]);export{Oe as default};
