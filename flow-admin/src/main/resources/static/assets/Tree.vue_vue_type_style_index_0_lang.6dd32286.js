var Pe=Object.defineProperty,Ue=Object.defineProperties;var He=Object.getOwnPropertyDescriptors;var de=Object.getOwnPropertySymbols;var ze=Object.prototype.hasOwnProperty,Xe=Object.prototype.propertyIsEnumerable;var ue=(e,o,k)=>o in e?Pe(e,o,{enumerable:!0,configurable:!0,writable:!0,value:k}):e[o]=k,F=(e,o)=>{for(var k in o||(o={}))ze.call(o,k)&&ue(e,k,o[k]);if(de)for(var k of de(o))Xe.call(o,k)&&ue(e,k,o[k]);return e},G=(e,o)=>Ue(e,He(o));var he=(e,o,k)=>new Promise((K,L)=>{var s=C=>{try{A(k.next(C))}catch(v){L(v)}},p=C=>{try{A(k.throw(C))}catch(v){L(v)}},A=C=>C.done?K(C.value):Promise.resolve(C.value).then(s,p);A((k=k.apply(e,o)).next())});import{z as Ye,A as ye,aB as Ge,aA as Q,ao as We,r as fe,j,S as O,T as Je,a0 as w,B as M,D as U,a7 as qe,ad as V,a1 as Z,a6 as H,ae as ke,J as ge,K as Qe,w as S,ab as R,ap as Ze,aC as Re,aS as et,ay as tt,u as h,n as pe,P as Ke,t as z,c5 as nt,o as xe,am as X,_ as ct,by as st,F as Se,G as _e,c6 as be,a4 as ve,as as Ce,bz as ee}from"./vendor.5879c5ca.js";import{j as at,I as te,az as lt,p as _,b as rt,_ as it,aV as Ae,a as ot,aj as dt,i as ne,aW as ut,aC as ht,ay as Te,W as yt,aX as ft,H as Le,ag as kt}from"./index.aeb7d9f7.js";import{u as gt}from"./useContextMenu.c42040e5.js";const pt=({icon:e})=>e?at(e)?Ye(te,{icon:e,class:"mr-1"}):te:null;var Ne;(function(e){e[e.SELECT_ALL=0]="SELECT_ALL",e[e.UN_SELECT_ALL=1]="UN_SELECT_ALL",e[e.EXPAND_ALL=2]="EXPAND_ALL",e[e.UN_EXPAND_ALL=3]="UN_EXPAND_ALL",e[e.CHECK_STRICTLY=4]="CHECK_STRICTLY",e[e.CHECK_UN_STRICTLY=5]="CHECK_UN_STRICTLY"})(Ne||(Ne={}));const Kt=ye({name:"BasicTreeHeader",components:{BasicTitle:lt,Icon:te,Dropdown:Ge,Menu:Q,MenuItem:Q.Item,MenuDivider:Q.Divider,InputSearch:We.Search},props:{helpMessage:{type:[String,Array],default:""},title:_.string,toolbar:_.bool,checkable:_.bool,search:_.bool,checkAll:_.func,expandAll:_.func,searchText:_.string},emits:["strictly-change","search"],setup(e,{emit:o,slots:k}){const{t:K}=rt(),L=fe(""),s=j(()=>{const n=k.headerTitle||e.title;return["mr-1","w-full",{["ml-5"]:n}]}),p=j(()=>{const{checkable:n}=e,a=[{label:K("component.tree.expandAll"),value:2},{label:K("component.tree.unExpandAll"),value:3,divider:n}];return n?[{label:K("component.tree.selectAll"),value:0},{label:K("component.tree.unSelectAll"),value:1,divider:n},...a,{label:K("component.tree.checkStrictly"),value:4},{label:K("component.tree.checkUnStrictly"),value:5}]:a});function A(n){var r,c,d,l;const{key:a}=n;switch(a){case 0:(r=e.checkAll)==null||r.call(e,!0);break;case 1:(c=e.checkAll)==null||c.call(e,!1);break;case 2:(d=e.expandAll)==null||d.call(e,!0);break;case 3:(l=e.expandAll)==null||l.call(e,!1);break;case 4:o("strictly-change",!1);break;case 5:o("strictly-change",!0);break}}function C(n){o("search",n)}const v=Je(C,200);return O(()=>L.value,n=>{v(n)}),O(()=>e.searchText,n=>{n!==L.value&&(L.value=n)}),{t:K,toolbarList:p,handleMenuClick:A,searchValue:L,getInputSearchCls:s}}}),xt={class:"flex px-2 py-1.5 items-center basic-tree-header"},St={key:2,class:"flex flex-1 justify-self-stretch items-center cursor-pointer"};function _t(e,o,k,K,L,s){const p=w("BasicTitle"),A=w("InputSearch"),C=w("Icon"),v=w("MenuItem"),n=w("MenuDivider"),a=w("Menu"),r=w("Dropdown");return M(),U("div",xt,[e.$slots.headerTitle?qe(e.$slots,"headerTitle",{key:0},void 0,!0):V("",!0),!e.$slots.headerTitle&&e.title?(M(),Z(p,{key:1,helpMessage:e.helpMessage},{default:H(()=>[ke(ge(e.title),1)]),_:1},8,["helpMessage"])):V("",!0),e.search||e.toolbar?(M(),U("div",St,[e.search?(M(),U("div",{key:0,class:Qe(e.getInputSearchCls)},[S(A,{placeholder:e.t("common.searchText"),size:"small",allowClear:"",value:e.searchValue,"onUpdate:value":o[0]||(o[0]=c=>e.searchValue=c)},null,8,["placeholder","value"])],2)):V("",!0),e.toolbar?(M(),Z(r,{key:1,onClick:o[1]||(o[1]=tt(()=>{},["prevent"]))},{overlay:H(()=>[S(a,{onClick:e.handleMenuClick},{default:H(()=>[(M(!0),U(R,null,Ze(e.toolbarList,c=>(M(),U(R,{key:c.value},[S(v,Re(et({key:c.value})),{default:H(()=>[ke(ge(c.label),1)]),_:2},1040),c.divider?(M(),Z(n,{key:0})):V("",!0)],64))),128))]),_:1},8,["onClick"])]),default:H(()=>[S(C,{icon:"ion:ellipsis-vertical"})]),_:1})):V("",!0)])):V("",!0)])}var bt=it(Kt,[["render",_t],["__scopeId","data-v-0443acce"]]);function vt(e,o){function k(n){const a=[],r=n||h(e),{key:c,children:d}=h(o);if(!d||!c)return a;for(let l=0;l<r.length;l++){const i=r[l];a.push(i[c]);const f=i[d];f&&f.length&&a.push(...k(f))}return a}function K(n){const a=[],r=n||h(e),{key:c,children:d}=h(o);if(!d||!c)return a;for(let l=0;l<r.length;l++){const i=r[l];i.disabled!==!0&&i.selectable!==!1&&a.push(i[c]);const f=i[d];f&&f.length&&a.push(...K(f))}return a}function L(n,a){const r=[],c=a||h(e),{key:d,children:l}=h(o);if(!l||!d)return r;for(let i=0;i<c.length;i++){const f=c[i],T=f[l];n===f[d]?(r.push(f[d]),T&&T.length&&r.push(...k(T))):T&&T.length&&r.push(...L(n,T))}return r}function s(n,a,r){if(!n)return;const c=r||h(e),{key:d,children:l}=h(o);if(!(!l||!d))for(let i=0;i<c.length;i++){const f=c[i],T=f[l];if(f[d]===n){c[i]=F(F({},c[i]),a);break}else T&&T.length&&s(n,a,f[l])}}function p(n=1,a,r=1){if(!n)return[];const c=[],d=a||h(e)||[];for(let l=0;l<d.length;l++){const i=d[l],{key:f,children:T}=h(o),W=f?i[f]:"",P=T?i[T]:[];c.push(W),P&&P.length&&r<n&&(r+=1,c.push(...p(n,P,r)))}return c}function A({parentKey:n=null,node:a,push:r="push"}){const c=pe(h(e));if(!n){c[r](a),e.value=c;return}const{key:d,children:l}=h(o);!l||!d||(Ae(c,i=>{if(i[d]===n)return i[l]=i[l]||[],i[l][r](a),!0}),e.value=c)}function C({parentKey:n=null,list:a,push:r="push"}){const c=pe(h(e));if(!(!a||a.length<1))if(n){const{key:d,children:l}=h(o);if(!l||!d)return;Ae(c,i=>{if(i[d]===n){i[l]=i[l]||[];for(let f=0;f<a.length;f++)i[l][r](a[f]);return e.value=c,!0}})}else for(let d=0;d<a.length;d++)c[r](a[d])}function v(n,a){if(!n)return;const r=a||h(e),{key:c,children:d}=h(o);if(!(!d||!c))for(let l=0;l<r.length;l++){const i=r[l],f=i[d];if(i[c]===n){r.splice(l,1);break}else f&&f.length&&v(n,i[d])}}return{deleteNodeByKey:v,insertNodeByKey:A,insertNodesByKey:C,filterByLevel:p,updateNodeByKey:s,getAllKeys:k,getChildrenKeys:L,getEnabledKeys:K}}const Ct={value:{type:[Object,Array]},renderIcon:{type:Function},helpMessage:{type:[String,Array],default:""},title:_.string,toolbar:_.bool,search:_.bool,searchValue:_.string,checkStrictly:_.bool,clickRowToExpand:_.bool.def(!0),checkable:_.bool.def(!1),defaultExpandLevel:{type:[String,Number],default:""},defaultExpandAll:_.bool.def(!1),replaceFields:{type:Object},treeData:{type:Array},actionList:{type:Array,default:()=>[]},expandedKeys:{type:Array,default:()=>[]},selectedKeys:{type:Array,default:()=>[]},checkedKeys:{type:Array,default:()=>[]},beforeRightClick:{type:Function,default:null},rightMenuList:{type:Array},filterFn:{type:Function,default:null},highlight:{type:[Boolean,String],default:!1},expandOnSearch:_.bool.def(!1),checkOnSearch:_.bool.def(!1),selectedOnSearch:_.bool.def(!1)};function At(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!st(e)}var Ft=ye({name:"BasicTree",inheritAttrs:!1,props:Ct,emits:["update:expandedKeys","update:selectedKeys","update:value","change","check","update:searchValue"],setup(e,{attrs:o,slots:k,emit:K,expose:L}){const s=Ke({checkStrictly:e.checkStrictly,expandedKeys:e.expandedKeys||[],selectedKeys:e.selectedKeys||[],checkedKeys:e.checkedKeys||[]}),p=Ke({startSearch:!1,searchText:"",searchData:[]}),A=fe([]),[C]=gt(),{prefixCls:v}=ot("basic-tree"),n=j(()=>{const{replaceFields:t}=e;return F({children:"children",title:"title",key:"key"},t)}),a=j(()=>{let t=G(F(F({blockNode:!0},o),e),{expandedKeys:s.expandedKeys,selectedKeys:s.selectedKeys,checkedKeys:s.checkedKeys,checkStrictly:s.checkStrictly,replaceFields:h(n),"onUpdate:expandedKeys":y=>{s.expandedKeys=y,K("update:expandedKeys",y)},"onUpdate:selectedKeys":y=>{s.selectedKeys=y,K("update:selectedKeys",y)},onCheck:(y,g)=>{let x=z(s.checkedKeys);if(dt(x)&&p.startSearch){const{key:b}=h(n);x=nt(x,P(g.node.$attrs.node[b])),g.checked&&x.push(g.node.$attrs.node[b]),s.checkedKeys=x}else s.checkedKeys=y;const u=z(s.checkedKeys);K("update:value",u),K("check",u,g)},onRightClick:Fe});return xe(t,"treeData","class")}),r=j(()=>p.startSearch?p.searchData:h(A)),c=j(()=>!r.value||r.value.length===0),{deleteNodeByKey:d,insertNodeByKey:l,insertNodesByKey:i,filterByLevel:f,updateNodeByKey:T,getAllKeys:W,getChildrenKeys:P,getEnabledKeys:Ee}=vt(A,n);function De(t,y){return!y&&e.renderIcon&&ne(e.renderIcon)?e.renderIcon(t):y}function Fe(g){return he(this,arguments,function*({event:t,node:y}){var D;const{rightMenuList:x=[],beforeRightClick:u}=e;let b={event:t,items:[]};if(u&&ne(u)){let N=yield u(y,t);Array.isArray(N)?b.items=N:Object.assign(b,N)}else b.items=x;!((D=b.items)==null?void 0:D.length)||C(b)})}function Y(t){s.expandedKeys=t}function Me(){return s.expandedKeys}function ce(t){s.selectedKeys=t}function Ie(){return s.selectedKeys}function se(t){s.checkedKeys=t}function me(){return s.checkedKeys}function ae(t){s.checkedKeys=t?Ee():[]}function J(t){s.expandedKeys=t?W():[]}function we(t){s.checkStrictly=t}O(()=>e.searchValue,t=>{t!==p.searchText&&(p.searchText=t)},{immediate:!0}),O(()=>e.treeData,t=>{t&&q(p.searchText)});function q(t){if(t!==p.searchText&&(p.searchText=t),K("update:searchValue",t),!t){p.startSearch=!1;return}const{filterFn:y,checkable:g,expandOnSearch:x,checkOnSearch:u,selectedOnSearch:b}=h(e);p.startSearch=!0;const{title:D,key:N}=h(n),I=[];if(p.searchData=ut(h(A),E=>{var m,$;const B=y?y(t,E,h(n)):($=(m=E[D])==null?void 0:m.includes(t))!=null?$:!1;return B&&I.push(E[N]),B},h(n)),x){const E=ht(p.searchData).map(B=>B[N]);E&&E.length&&Y(E)}u&&g&&I.length&&se(I),b&&I.length&&ce(I)}function Be(t,y){if(!(!e.clickRowToExpand||!y||y.length===0))if(!s.expandedKeys.includes(t))Y([...s.expandedKeys,t]);else{const g=[...s.expandedKeys],x=g.findIndex(u=>u===t);x!==-1&&g.splice(x,1),Y(g)}}X(()=>{A.value=e.treeData}),ct(()=>{const t=parseInt(e.defaultExpandLevel);t>0?s.expandedKeys=f(t):e.defaultExpandAll&&J(!0)}),X(()=>{s.expandedKeys=e.expandedKeys}),X(()=>{s.selectedKeys=e.selectedKeys}),X(()=>{s.checkedKeys=e.checkedKeys}),O(()=>e.value,()=>{s.checkedKeys=z(e.value||[])}),O(()=>s.checkedKeys,()=>{const t=z(s.checkedKeys);K("update:value",t),K("change",t)}),X(()=>{s.checkStrictly=e.checkStrictly}),L({setExpandedKeys:Y,getExpandedKeys:Me,setSelectedKeys:ce,getSelectedKeys:Ie,setCheckedKeys:se,getCheckedKeys:me,insertNodeByKey:l,insertNodesByKey:i,deleteNodeByKey:d,updateNodeByKey:T,checkAll:ae,expandAll:J,filterByLevel:t=>{s.expandedKeys=f(t)},setSearchValue:t=>{q(t)},getSearchValue:()=>p.searchText});function $e(t){const{actionList:y}=e;if(!(!y||y.length===0))return y.map((g,x)=>{var b;let u=!0;return ne(g.show)?u=(b=g.show)==null?void 0:b.call(g,t):Le(g.show)&&(u=g.show),u?S("span",{key:x,class:`${v}__action`},[g.render(t)]):null})}function le({data:t,level:y}){if(!t)return null;const g=p.searchText,{highlight:x}=h(e);return t.map(u=>{var re;const{title:b,key:D,children:N}=h(n),I=xe(u,"title"),E=De(G(F({},u),{level:y}),u.icon),B=ee(u,N)||[],m=ee(u,b),$=g?m.indexOf(g):-1,je=p.startSearch&&!ft(g)&&x&&$!==-1,Oe=`color: ${Le(x)?"#f50":x}`,Ve=je?S("span",{class:((re=h(a))==null?void 0:re.blockNode)?`${v}__content`:""},[S("span",null,[m.substr(0,$)]),S("span",{style:Oe},[g]),S("span",null,[m.substr($+g.length)])]):m;return S(be.TreeNode,ve(I,{node:z(u),key:ee(u,D)}),{title:()=>{var ie,oe;return S("span",{class:`${v}-title pl-2`,onClick:Be.bind(null,u[D],u[N])},[((ie=u.slots)==null?void 0:ie.title)?kt(k,(oe=u.slots)==null?void 0:oe.title,u):S(R,null,[E&&S(pt,{icon:E},null),Ve,S("span",{class:`${v}__actions`},[$e(G(F({},u),{level:y}))])])])},default:()=>le({data:B,level:y+1})})})}return()=>{let t;const{title:y,helpMessage:g,toolbar:x,search:u,checkable:b}=e,D=y||x||u||k.headerTitle,N={height:"calc(100% - 38px)"};return S("div",{class:[v,"h-full",o.class]},[D&&S(bt,{checkable:b,checkAll:ae,expandAll:J,title:y,search:u,toolbar:x,helpMessage:g,onStrictlyChange:we,onSearch:q,searchText:p.searchText},At(t=Te(k))?t:{default:()=>[t]}),Se(S(yt,{style:N},{default:()=>[S(be,ve(h(a),{showIcon:!1}),F({default:()=>le({data:h(r),level:1})},Te(k)))]}),[[_e,!h(c)]]),Se(S(Ce,{image:Ce.PRESENTED_IMAGE_SIMPLE,class:"!mt-4"},null),[[_e,h(c)]])])}}});export{Ft as _};
