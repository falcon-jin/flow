var I=Object.defineProperty;var g=Object.getOwnPropertySymbols;var x=Object.prototype.hasOwnProperty,y=Object.prototype.propertyIsEnumerable;var E=(t,u,e)=>u in t?I(t,u,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[u]=e,B=(t,u)=>{for(var e in u||(u={}))x.call(u,e)&&E(t,e,u[e]);if(g)for(var e of g(u))y.call(u,e)&&E(t,e,u[e]);return t};var f=(t,u,e)=>new Promise((l,n)=>{var d=o=>{try{s(e.next(o))}catch(i){n(i)}},r=o=>{try{s(e.throw(o))}catch(i){n(i)}},s=o=>o.done?l(o.value):Promise.resolve(o.value).then(d,r);s((e=e.apply(t,u)).next())});import{B as _,a as R}from"./index.309f7e13.js";import{B as A}from"./BasicForm.bfb70ce4.js";import{u as N}from"./useForm.9d0149a6.js";import{c as P,s as j}from"./role.56cae01d.js";import{g as M}from"./company.711332d1.js";import{F as v}from"./constantEnum.82824ec7.js";import{_ as S}from"./index.aeb7d9f7.js";import{A as k,r as q,u as h,j as T,a0 as C,B as $,a1 as O,a6 as V,w as L,a4 as U}from"./vendor.5879c5ca.js";const ae=[{title:"\u540D\u79F0",dataIndex:"name",align:"left"},{title:"\u7F16\u7801",dataIndex:"sn",width:120,align:"left"},{title:"\u6240\u5C5E\u516C\u53F8",dataIndex:"companyName",width:120,align:"left"},{title:"\u521B\u5EFA\u65F6\u95F4",dataIndex:"createTime",width:180},{title:"\u64CD\u4F5C",dataIndex:"action",width:120,slots:{customRender:"action"}}],oe=[{title:"\u64CD\u4F5C",dataIndex:"action",width:50,slots:{customRender:"action"}},{dataIndex:"name",align:"left",width:200,slots:{title:"customName"},customRender:({record:t})=>t.name+" - ["+t.code+"]"},{title:"\u6240\u5C5E\u516C\u53F8",dataIndex:"companyName",align:"left"},{title:"\u6240\u5C5E\u90E8\u95E8",dataIndex:"deptName",align:"left"}],se=[{field:"keyword",label:"\u5173\u952E\u5B57",component:"Input",componentProps:{placeholder:"\u8BF7\u8F93\u5165\u540D\u79F0/\u6807\u8BC6"},labelWidth:60,colProps:{span:6,lg:{span:8,offset:0},sm:{span:14,offset:0},xs:{span:16,offset:0}}}],W=[{field:"id",label:"ID",required:!1,component:"Input",show:!1},{field:"name",label:"\u540D\u79F0",component:"Input",required:!0,rules:[{required:!0,whitespace:!0,message:"\u7F16\u7801\u4E0D\u80FD\u4E3A\u7A7A\uFF01"},{max:64,message:"\u5B57\u7B26\u957F\u5EA6\u4E0D\u80FD\u5927\u4E8E64\uFF01"}]},{field:"sn",label:"\u7F16\u7801",component:"Input",required:!0},{field:"companyId",label:"\u6240\u5C5E\u516C\u53F8",component:"TreeSelect",componentProps:{treeNodeFilterProp:"cname",replaceFields:{title:"cname",key:"id",value:"id"},getPopupContainer:()=>document.body},required:!0},{field:"orderNo",label:"\u6392\u5E8F\u53F7",required:!1,component:"InputNumber"},{label:"\u5907\u6CE8",field:"note",component:"InputTextArea",rules:[{max:1024,message:"\u5B57\u7B26\u957F\u5EA6\u4E0D\u80FD\u5927\u4E8E1024\uFF01"}]}],z=k({name:"RoleModal",components:{BasicModal:_,BasicForm:A},emits:["success","register"],setup(t,{emit:u}){const e=q(!0),[l,{setFieldsValue:n,updateSchema:d,resetFields:r,validate:s}]=N({labelWidth:100,schemas:W,showActionButtonGroup:!1,actionColOptions:{span:23}}),o=a=>[{trigger:"blur",validator:(m,c)=>c?P({id:a.id,field:a.field,fieldValue:c,fieldName:a.fieldName}).then(F=>F?Promise.resolve():Promise.reject(a.fieldName+"\u5DF2\u5B58\u5728\uFF0C\u8BF7\u4FEE\u6539\uFF01")).catch(F=>Promise.reject(F)):Promise.resolve()}],[i,{setModalProps:p,closeModal:D}]=R(a=>f(this,null,function*(){yield r(),p({confirmLoading:!1}),e.value=!!(a==null?void 0:a.isUpdate);let m=a.record;const c=yield M();yield d([{field:"companyId",componentProps:{treeData:c}},{field:"sn",dynamicRules:()=>[{required:!0,whitespace:!0,message:"\u7F16\u7801\u4E0D\u80FD\u4E3A\u7A7A\uFF01"},{pattern:new RegExp(v.SN),type:"string",message:"\u8BF7\u8F93\u5165\u82F1\u6587\u6216\u6570\u5B57\uFF01"},{max:64,message:"\u5B57\u7B26\u957F\u5EA6\u4E0D\u80FD\u5927\u4E8E64\uFF01"},...o({id:h(e)&&m&&m.id||"",field:"sn",fieldValue:"",fieldName:"\u7F16\u7801"})]}]),n(B({},m))})),b=T(()=>h(e)?"\u4FEE\u6539":"\u65B0\u589E");function w(){return f(this,null,function*(){try{p({confirmLoading:!0});const a=yield s();yield j(a),D(),u("success")}finally{p({confirmLoading:!1})}})}return{registerModal:i,registerForm:l,getTitle:b,handleSubmit:w}}});function G(t,u,e,l,n,d){const r=C("BasicForm"),s=C("BasicModal");return $(),O(s,U(t.$attrs,{onRegister:t.registerModal,title:t.getTitle,onOk:t.handleSubmit}),{default:V(()=>[L(r,{onRegister:t.registerForm},null,8,["onRegister"])]),_:1},16,["onRegister","title","onOk"])}var H=S(z,[["render",G]]),ne=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:H});export{H as R,ne as a,ae as c,oe as p,se as s};
