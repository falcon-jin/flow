var f=(e,a,t)=>new Promise((n,c)=>{var s=o=>{try{d(t.next(o))}catch(l){c(l)}},r=o=>{try{d(t.throw(o))}catch(l){c(l)}},d=o=>o.done?n(o.value):Promise.resolve(o.value).then(s,r);d((t=t.apply(e,a)).next())});import{bc as b,aV as I,ax as h,_ as x,p as u}from"./index.aeb7d9f7.js";import{A as L,a$ as m,aP as S,r as g,a0 as k,B as A,D as y,w as v,a6 as C,a1 as G,ad as M,ae as B}from"./vendor.5879c5ca.js";/* empty css              */var i;(function(e){e.SetAcl="/flow/privilege/acl/setAcl",e.GetModuleAclsByGroupId="/flow/privilege/acl/getModuleAclsByGroupId",e.SetAllAcl="/flow/privilege/acl/setAllAcl",e.SetAclModuleList="/flow/privilege/acl/setAclModuleList",e.SetAclByModule="/flow/privilege/acl/setAclByModule"})(i||(i={}));const P=e=>{const a=h.get({url:i.GetModuleAclsByGroupId+"/"+e.groupId});return Promise.resolve(a).then(t=>{const n=b(t,{id:"id",children:"children",pid:"pid"});return I(n,c=>{c.children.length===0&&delete c.children},{id:"id",children:"children",pid:"pid"}),n})},z=e=>h.post({url:i.SetAllAcl+`/${e.checked}`,params:e.aclInfo}),_=e=>h.post({url:i.SetAclByModule+"/"+e.checked,params:e.aclInfo}),w=e=>h.post({url:i.SetAclModuleList+`/${e.moduleId}/${e.groupId}`,params:e.aclList}),$=L({name:"AclCheckboxGroup",components:{Checkbox:m,CheckboxGroup:m.Group,Spin:S},props:{checkboxList:u.arrayOf(u.object).def([]),groupId:u.string.def(""),moduleSn:u.string.def(""),moduleId:u.string.def("")},setup(e,{emit:a}){const t=e.checkboxList.filter(l=>l.checked),n=g(!1),c=g(t.length>0&&e.checkboxList.length===t.length);t.length!==0&&e.checkboxList.length!==t.length&&(n.value=!0);const s=g(!1),r=g(t.map(l=>l.value));function d(l){return f(this,null,function*(){s.value=!0,n.value=!!l.length&&l.length<e.checkboxList.length,c.value=l.length===e.checkboxList.length;const p={moduleId:e.moduleId,groupId:e.groupId,aclList:l};try{yield w(p),a("changeCheckAllStatus")}finally{s.value=!1}})}function o(l){return f(this,null,function*(){r.value=l.target.checked?e.checkboxList.map(p=>p.value):[],n.value=!1,c.value=l.target.checked,s.value=!0,yield _({checked:l.target.checked?1:0,aclInfo:{releaseId:e.groupId,moduleId:e.moduleId}}),a("changeCheckAllStatus"),s.value=!1})}return{spinning:s,indeterminate:n,checkAll:c,checkedList:r,onChange:d,onCheckAllChange:o}}}),j=B(" \u5168\u9009 ");function T(e,a,t,n,c,s){const r=k("Checkbox"),d=k("CheckboxGroup"),o=k("Spin");return A(),y("div",null,[v(o,{spinning:e.spinning},{default:C(()=>[e.checkboxList&&e.checkboxList.length>0?(A(),G(r,{key:0,indeterminate:e.indeterminate,checked:e.checkAll,onChange:e.onCheckAllChange},{default:C(()=>[j]),_:1},8,["indeterminate","checked","onChange"])):M("",!0),v(d,{value:e.checkedList,"onUpdate:value":a[0]||(a[0]=l=>e.checkedList=l),options:e.checkboxList,onChange:e.onChange},null,8,["value","options","onChange"])]),_:1},8,["spinning"])])}var V=x($,[["render",T]]),H=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:V});export{V as A,H as a,P as g,z as s};
